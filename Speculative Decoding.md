Feb 2, 2023
DeepMind Paper: [Accelerating Large Language Model Decoding with Speculative Sampling](https://arxiv.org/abs/2302.01318)

Additional References
- [Video: Speculative Decoding: When two LLMs are Faster than One](https://www.youtube.com/watch?v=S-8yr_RibJ4)

Abstract
> We present speculative sampling, an algorithm for accelerating transformer decoding by enabling the generation of multiple tokens from each transformer call. Our algorithm relies on the observation that the latency of parallel scoring of short continuations, generated by a faster but less powerful draft model, is comparable to that of sampling a single token from the larger target model. This is combined with a novel modified rejection sampling scheme which preserves the distribution of the target model within hardware numerics. We benchmark speculative sampling with Chinchilla, a 70 billion parameter language model, achieving a 2-2.5x decoding speedup in a distributed setup, without compromising the sample quality or making modifications to the model itself.



![[Pasted image 20240424185642.png]]
Above: Both DeepMind and Google Research ran experiments and found ~2-3x speedups, recommending k values of ~3-5.


((Not sure the below are relevant))
To cover:
- Theshold decoding
- Staged speculative decoded
- Guided generation
- Lookahead decoding 
- Prompt lookup decoding